<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <title>&#x7CFB;&#x7EDF;&#x6811;</title>
    <style>::-webkit-scrollbar{display:none;}html,body{overflow:hidden;}</style>
</head>
<body>
<div id="mountNode"></div>
<script>
/*Fixing iframe window.innerHeight 0 issue in Safari*/
document.body.clientHeight;
</script>
<script src="https://unpkg.com/@antv/g6@2.0.0-beta.85/dist/g6.js"></script>
<script src="https://unpkg.com/@antv/g6@2.0.0-beta.85/dist/g6.js"></script>
<script src="https://gw.alipayobjects.com/os/antv/assets/lib/jquery-3.2.1.min.js"></script>
<script>
G6.registerNode('treeNode', {
  anchor: [[0, 0.5], [1, 0.5]]
});
G6.registerEdge('smooth', {
  getPath: function getPath(item) {
    var points = item.getPoints();
    var start = points[0];
    var end = points[points.length - 1];
    var hgap = Math.abs(end.x - start.x);
    if (end.x > start.x) {
      return [['M', start.x, start.y], ['C', start.x + hgap / 4, start.y, end.x - hgap / 2, end.y, end.x, end.y]];
    }
    return [['M', start.x, start.y], ['C', start.x - hgap / 4, start.y, end.x + hgap / 2, end.y, end.x, end.y]];
  }
});

$.getJSON('/assets/data/modeling-methods.json', function(data) {
  var Util = G6.Util;
  // 准备布局配置
  var layoutCfg = {
    "direction": "LR",
    "nodeSize": 20,
    "rankSep": 400
  };
  // 自定义树节点
  var DEFAULT_NODE_SIZE = layoutCfg.nodeSize;
  // 生成树图实例
  var layout = new G6.Layouts.Dendrogram(layoutCfg);
  var tree = new G6.Tree({
    id: 'mountNode',
    layout: layout,
    height: window.innerHeight, // 画布高
    fitView: 'autoZoom', // 自动缩放
    showButton: false
  });

  tree.node({
    shape: 'treeNode',
    size: 8
  }).label(function(obj) {
    return obj.name;
  });
  tree.edge({
    shape: 'smooth'
  });
  tree.on('afterchange', function() {
    tree.getNodes().forEach(function(node) {
      var model = node.getModel();
      var label = node.getLabel();
      var keyShape = node.getKeyShape();
      var children = node.getChildren();
      var parent = node.getParent();
      var box = keyShape.getBBox();
      var labelBox = label.getBBox();
      var dx = (box.maxX - box.minX + labelBox.maxX - labelBox.minX) / 2 + 8;
      var dy = 0;
      if (children.length != 0) {
        dx = -dx;
      }
      label.translate(dx, dy);
    });
    tree.draw();
  });

  // 加载数据
  // 渲染树图
  tree.read({
    roots: [data]
  });
});
</script>


</body></html>