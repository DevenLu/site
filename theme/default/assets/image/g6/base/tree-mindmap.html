<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <title>&#x8111;&#x56FE;&#x6811;</title>
    <style>::-webkit-scrollbar{display:none;}html,body{overflow:hidden;}</style>
</head>
<body>
<div id="mountNode"></div>
<script>
/*Fixing iframe window.innerHeight 0 issue in Safari*/
document.body.clientHeight;
</script>
<script src="https://unpkg.com/@antv/g6@2.0.0-beta.85/dist/g6.js"></script>
<script src="https://unpkg.com/@antv/g6@2.0.0-beta.85/dist/g6.js"></script>
<script src="https://gw.alipayobjects.com/os/antv/assets/lib/jquery-3.2.1.min.js"></script>
<script>
var Util = G6.Util;
// 注册脑图节点
G6.registerNode('mindNode', {
  anchor: [[0, 0.5], [1, 0.5]]
});
// 注册脑图边
G6.registerEdge('mindEdge', {
  getPath: function getPath(item) {
    var points = item.getPoints();
    var start = points[0];
    var end = points[points.length - 1];
    var hgap = Math.abs(end.x - start.x);
    if (end.x > start.x) {
      return [['M', start.x, start.y], ['C', start.x + hgap / 4, start.y, end.x - hgap / 2, end.y, end.x, end.y]];
    }
    return [['M', start.x, start.y], ['C', start.x - hgap / 4, start.y, end.x + hgap / 2, end.y, end.x, end.y]];
  }
});
$.getJSON('/assets/data/modeling-methods.json', function(data) {
  var layout = new G6.Layouts.Mindmap({
    direction: 'H', // 方向（LR/RL/H/TB/BT/V）
    getHGap: function getHGap() /* d */ {
      // 横向间距
      return 100;
    },
    getVGap: function getVGap() /* d */ {
      // 竖向间距
      return 10;
    }
  });
  var tree = new G6.Tree({
    id: 'mountNode', // 容器ID
    height: window.innerHeight, // 画布高
    fitView: 'autoZoom', // 自动缩放
    layout: layout
  });
  tree.node({
    label: function label(model) {
      return {
        text: model.name,
        stroke: '#fff',
        lineWidth: 3
      };
    },

    size: 8,
    shape: 'mindNode'
  });
  tree.edge({
    shape: 'mindEdge'
  });
  tree.on('afterchange', function() {
    tree.getNodes().forEach(function(node) {
      var model = node.getModel();
      var label = node.getLabel();
      var keyShape = node.getKeyShape();
      var parent = node.getParent();
      var box = keyShape.getBBox();
      var labelBox = label.getBBox();
      var dx = (box.maxX - box.minX + labelBox.maxX - labelBox.minX) / 2 + 8;
      var dy = (box.maxY - box.minY) / 2 + 8;
      if (parent) {
        var parentModel = parent.getModel();
        if (parentModel.x > model.x) {
          dx = -dx;
        }
        dy = 0;
      } else {
        dx = 0;
      }
      label.translate(dx, dy);
    });
    tree.draw();
  });
  tree.read({
    roots: [data]
  });
});
</script>


</body></html>