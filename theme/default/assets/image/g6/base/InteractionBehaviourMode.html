<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <title>&#x4EA4;&#x4E92;-&#x6A21;&#x5F0F;&#x4E0E;&#x884C;&#x4E3A;</title>
    <style>::-webkit-scrollbar{display:none;}html,body{overflow:hidden;}</style>
</head>
<body>
<div id="mountNode"></div>
<script>
/*Fixing iframe window.innerHeight 0 issue in Safari*/
document.body.clientHeight;
</script>
<script src="https://unpkg.com/@antv/g6@2.0.0-beta.85/dist/g6.js"></script>
<script src="https://unpkg.com/@antv/g6@2.0.0-beta.85/dist/g6.js"></script>
<script src="https://gw.alipayobjects.com/os/antv/assets/lib/jquery-3.2.1.min.js"></script>
<script>
$('body').html('<button id="changeMode">切换模式</button><div id="mountNode"></div>说明：事件在 G6 中是粒度最小的交互接口，一般最简单的交互，我们可以直接通过写事件完成。但在一些交互非常复杂的场景里，我们往往比较难管理各个事件之间信号量的传递。针对复杂交互的场景，G6 总结了一套行为模式的解决方案。</br></br>这套方案简单介绍就是：事件组成行为，行为构成模式。我们可以通过事件实现任何粒度的交互组成行为，再通过不同行为的组合，得出模式。通过模式的切换，我们可以将不同的交互很轻易分离开来，从而规避大量信号量的传递。');
// 注册鼠标进入节点变红的行为
G6.registerBehaviour('mouseEnterFillRed', function(graph) {
  graph.behaviourOn('node:mouseenter', function(ev) {
    graph.update(ev.item, {
      color: 'red'
    });
  });
});

// 注册鼠标进入节点变绿的行为
G6.registerBehaviour('mouseEnterFillGreen', function(graph) {
  graph.behaviourOn('node:mouseenter', function(ev) {
    graph.update(ev.item, {
      color: 'green'
    });
  });
});

// 注册鼠标移出节点变原色的行为
G6.registerBehaviour('mouseLeaveResetFill', function(graph) {
  graph.behaviourOn('node:mouseleave', function(ev) {
    graph.update(ev.item, {
      color: '#1890FF'
    });
  });
});
var data = {
  nodes: [{
    id: '事件',
    x: 80,
    y: 150
  }, {
    id: '行为',
    x: 200,
    y: 150
  }, {
    id: '模式',
    x: 320,
    y: 150
  }],
  edges: [{
    source: '事件',
    target: '行为',
    label: '组成'
  }, {
    source: '行为',
    target: '模式',
    label: '组成'
  }]
};
var mode = 'red';
var graph = new G6.Graph({
  container: 'mountNode',
  fitView: 'cc',
  height: window.innerHeight,
  modes: {
    red: ['mouseEnterFillRed', 'mouseLeaveResetFill'],
    green: ['mouseEnterFillGreen', 'mouseLeaveResetFill']
  },
  mode: mode
});
graph.node({
  label: function label(model) {
    return model.id;
  }
});
graph.edge({
  style: function style() {
    return {
      endArrow: true
    };
  }
});
graph.read(data);

// 点击按钮切换模式
document.getElementById('changeMode').onclick = function() {
  if (mode === 'red') {
    graph.changeMode('green');
    mode = 'green';
  } else {
    graph.changeMode('red');
    mode = 'red';
  }
};
</script>


</body></html>