<!--
index: 0
title: 股票图
resource:
  jsFiles:
    - ${url.dataSet}
    - ${url.jquery}
plotDescription: K 线图，原名蜡烛图，又称阴阳图、棒线、红黑线或蜡烛线，常用于展示股票交易数据。
plotUsage: K 线图主要用于金融领域里展示股票，期货等交易数据，按照时间维度分为日 K 线、周 K 线、月 K 线。展示的数据需要满足 K 线构成的四要素：即开盘价、收盘价、最高价、最低价。
relativePlots:

-->

<script>
  const { DataView } = DataSet;
  $.getJSON('/assets/data/candle-sticks.json',function(data) {
    const chart = new G2.Chart({
      container: 'mountNode',
      forceFit: true,
      height: window.innerHeight
    });
    const dv = new DataView();
    dv.source(data)
      .transform({
        type: 'map',
        callback: obj => {
          obj.trend = (obj.start <= obj.end) ? '上涨' : '下跌';
          obj.range = [ obj.start, obj.end, obj.max, obj.min ];
          return obj;
        }
      });
    chart.source(dv, {
      'trend': {
        alias: '趋势'
      },
      'time': {
        type: 'timeCat',
        nice: false,
        mask: 'MM-DD',
        alias: '时间',
        tickCount: 10
      },
      'volumn': {alias: '成交量'},
      'start': {alias: '开盘价'},
      'end': {alias: '收盘价'},
      'max': {alias: '最高价'},
      'min': {alias: '最低价'},
      'range': {alias: '股票价格'}
      });
    chart.tooltip({
      showTitle: false,
      itemTpl: '<li data-index={index} style="margin-bottom:4px;">'
        + '<span style="background-color:{color};" class="g2-tooltip-marker"></span>'
        + '{name}<br/>'
        + '<span style="padding-left: 16px">开盘价：{start}</span><br/>'
        + '<span style="padding-left: 16px">收盘价：{end}</span><br/>'
        + '<span style="padding-left: 16px">最高价：{max}</span><br/>'
        + '<span style="padding-left: 16px">最低价：{min}</span><br/>'
        + '<span style="padding-left: 16px">成交量：{volumn}</span><br/>'
        + '</li>'
    });
    chart.schema()
      .position('time*range')
      .color('trend', ['#f04864', '#2fc25b'])
      .shape('candle')
      .tooltip('time*start*end*max*min*volumn', (time, start, end, max, min, volumn) => {
        return {
          name: time,
          start,
          end,
          max,
          min,
          volumn
        };
      });
    chart.render();
  });
</script>
